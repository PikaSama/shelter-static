/*
 Author: Zorin
 Github: https://github.com/PikaSama
 License: GPL-3.0 License
 Description: Setter of custom config page.
 */
(async()=>{const i=".φbk.φh.φz h2",e=".φbk.φh.φz h3",a=window.location.pathname,n=$("head"),p=".ns-box.ns-growl.ns-effect-jelly.ns-type-error",t=localStorage.getItem("newbie"),s=localStorage.getItem("custom"),l=localStorage.getItem("night");let d="0",b="0",o="0",r="0",c="0",u="1",m="0",v="https://cdn.jsdelivr.net/npm/alus@latest\nhttps://cdn.jsdelivr.net/gh/MiniValine/Bilibilis@latest\nhttps://cdn.jsdelivr.net/gh/MiniValine/twemoji@latest\nhttps://cdn.jsdelivr.net/gh/PikaSama/blog-emoticons@1.1.2/bilibiliHotKey\nhttps://cdn.jsdelivr.net/gh/PikaSama/blog-emoticons@1.1.2/HONKAI3-Daily\nhttps://cdn.jsdelivr.net/gh/PikaSama/blog-emoticons@1.1.2/HONKAI3-NEWYEAR-2019\nhttps://cdn.jsdelivr.net/gh/PikaSama/blog-emoticons@1.1.2/HONKAI3-AIChan\nhttps://cdn.jsdelivr.net/gh/PikaSama/blog-emoticons@1.1.2/Coolapk";const g=(e,a)=>{$(a).insertAfter(i+":eq("+e+")")},f=(i,a)=>{$(a).insertAfter(e+":eq("+i+")")},_=(i,e)=>{$("input#"+i+"_"+e).attr("checked","")},w=i=>{$("input#autonight_"+i).click(()=>{d=i})},h=i=>{$("input#theme_"+i).click(()=>{b=i})},y=i=>{$("input#widget_"+i).click(()=>{o=i})},A=i=>{$("input#sidebar_"+i).click(()=>{r=i})},k=i=>{$("input#effect_"+i).click(()=>{c=i})},I=i=>{$("input#live2d_"+i).click(()=>{u=i})},S=i=>{$("input#wordcount_"+i).click(()=>{m=i})},N=()=>{localStorage.setItem("auto_night",d),localStorage.setItem("default_theme",b),localStorage.setItem("default_theme_widget",o),localStorage.setItem("sidebar_widget_background",r),localStorage.setItem("click_effect",c),localStorage.setItem("live2d",u),localStorage.setItem("wordcount_mode",m),localStorage.setItem("bqb_url",v)},K=()=>{"1"==l&&($(".input-radio").attr("class","input-radio-night"),$("textarea#mvsys").attr("id","mvsys-night"))},H=()=>{"1"==l?$('<div class="button-save"><span>保存<i class="ri-save-3-line"></i></span></div>').insertAfter(".input-radio-night:eq(29)"):$('<div class="button-save"><span>保存<i class="ri-save-3-line"></i></span></div>').insertAfter(".input-radio:eq(29)")},O=async()=>{w(0),w(1),h(0),h(1),h(2),h(3),h(4),y(0),y(1),y(2),y(3),y(4),y(5),y(6),y(7),y(8),y(9),y(10),y(11),y(12),A(0),A(1),k(0),k(1),k(2),I(0),I(1),S(0),S(1),S(2),$(".button-save").click(async()=>{v=null!=document.querySelector("textarea#mvsys")?$("textarea#mvsys").val():$("textarea#mvsys-night").val(),N(),$(".button-save").attr("class","button-save-disabled"),await(async()=>{null==document.querySelector(p)?n.append('<link id="jelly" href="//cdn.jsdelivr.net/gh/PikaSama/shelter-images@1.3.12/static/ns-style-growl.css" rel="stylesheet">'):null!=document.querySelector(p+".ns-show")?($(p).attr("id","canceled"),await delay(500),$(p).remove()):$(p).remove()})(),await(async()=>{await delay(1e3),new NotificationFx({wrapper:document.body,message:'<p>🔔【消息】<br />你的配置文件保存成功啦~<br />博客将会在几秒后刷新页面，请耐心等待~<br />无法刷新？试试&nbsp;&nbsp;<a href="https://shelter.beaa.cn/settings">手动刷新</a></p>',layout:"growl",effect:"jelly",type:"error",ttl:4e3,onClose:function(){return!1},onOpen:function(){return!1}}).show(),await delay(3e3),window.location.reload()})()}),await delay(2e3),$("div.loadAni").hide(1e3,"linear")},q=async()=>{d=localStorage.getItem("auto_night"),f(0,'<p>是否自动切换黑暗模式</p><p>注意：若开启此选项，在黑暗模式的工作时间内将会覆盖默认主题，设置为黑暗主题</p><p>黑暗模式时间段：19:00~6:00</p><div class="input-radio"><input id="autonight_1"type="radio"name="autonight"/><label for="autonight_1"><span>是&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="autonight_0"type="radio"name="autonight"/><label for="autonight_0"><span>否&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div>'),_("autonight",d),b=localStorage.getItem("default_theme"),f(1,'<p>默认的主题样式，共3种可选</p><div class="input-radio"><input id="theme_0"type="radio"name="theme"/><label for="theme_0"><span>默认&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="theme_1"type="radio"name="theme"/><label for="theme_1"><span>黑暗&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="theme_2"type="radio"name="theme"/><label for="theme_2"><span>樱花&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="theme_3"type="radio"name="theme"/><label for="theme_3"><span>雨滴&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="theme_4"type="radio"name="theme"/><label for="theme_4"><span>陈年旧书&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div>'),_("theme",b),o=localStorage.getItem("default_theme_widget"),f(2,'<p>默认的强调色主题，修改行内代码块，小圆点部件，按钮激活色，滚动条颜色等，可与上面的主题进行搭配，共有12种选择</p><p>注意：背景指侧边栏背景，仅适用于移动端，无特别标注的强调色的背景为纯色背景</p><div class="input-radio"><input id="widget_0"type="radio"name="widget"/><label for="widget_0"><span>默认(清新蓝)&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_1"type="radio"name="widget"/><label for="widget_1"><span>活力橙(黑眼镜橙色底背景)&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_2"type="radio"name="widget"/><label for="widget_2"><span>DDの桃(粉色渐变背景)&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_3"type="radio"name="widget"/><label for="widget_3"><span>夜の海(黑色海洋背景)&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_4"type="radio"name="widget"/><label for="widget_4"><span>基佬紫&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_5"type="radio"name="widget"/><label for="widget_5"><span>夜空蓝&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_6"type="radio"name="widget"/><label for="widget_6"><span>天依蓝&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_7"type="radio"name="widget"/><label for="widget_7"><span>奥托绿&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_8"type="radio"name="widget"/><label for="widget_8"><span>清新绿&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_9"type="radio"name="widget"/><label for="widget_9"><span>清新橙&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_10"type="radio"name="widget"/><label for="widget_10"><span>普通橙&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_11"type="radio"name="widget"/><label for="widget_11"><span>马鞍棕&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_12"type="radio"name="widget"/><label for="widget_12"><span>酷炫黑&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div>'),_("widget",o),r=localStorage.getItem("sidebar_widget_background"),f(3,'<p>使用强调色时是否更改侧边栏的背景为强调色自带的背景</p><p>注意：此选项仅针对移动端，PC端设置此选项无效</p><div class="input-radio"><input id="sidebar_1" type="radio" name="sidebar" /><label for="sidebar_1"><span>是&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="sidebar_0" type="radio" name="sidebar" /><label for="sidebar_0"><span>否&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div>'),_("sidebar",r),v=localStorage.getItem("bqb_url"),$('<p>你可以自定义评论系统加载的表情包，一行填一个链接，不需要其他符号，以免解析错误</p><center><textarea id="mvsys" rows="10" style="resize: none;"></textarea></center><p>目前博客自带的表情包有以下这些，如果要使用这些表情包，请填入“https://cdn.jsdelivr.net/gh/PikaSama/blog-emoticons@latest/” + 表情包名字 即可</p><ul><li><p>BilibiliHotKey：哔哩哔哩热词系列</p></li><li><p>HONKAI3-Crayon：崩坏3 蜡笔日常篇</p></li><li><p>HONKAI3-Daily：崩坏3 日常篇</p></li><li><p>HONKAI3-Durandal-Search： 崩坏3 目标！幽兰黛尔</p></li><li><p>HONKAI3-MEI：崩坏3 芽衣的剑道修行</p></li><li><p>HONKAI3-NEWYEAR-2019：崩坏3 2019新年</p></li><li><p>HONKAI3-Pure：崩坏3 纯色日常篇</p></li><li><p>HONKAI3-Stan：崩坏3 史丹</p></li><li><p>HONKAI3-Star：崩坏3 观星篇</p></li><li><p>HONKAI3-AIChan：崩坏3 爱酱</p></li><li><p>Mafumafu：Mafumafu Animation sticker (cat)</p></li><li><p>Menhera-chan：七濑胡桃系列表情包</p></li><li><p>Sweetie-Bunny：うさみみ少女</p></li><li><p>Coolapk：酷安</p></li><li><p>Arcaea：Arcaea表情包</p></li><li><p>Snow-Miku：Snow Miku雪初音表情包</p></li><li><p>Yurui-Neko：Yurui-Neko表情包</p></li><li><p>bilibilitv：哔哩哔哩小电视系列\t</p></li><li><p>bilibili2233：哔哩哔哩2233娘系列</p></li><li><p>aodamiao：aodamiao嗷大喵</p></li></ul><p>如果你想加入自己的表情包，请见<a href="https://github.com/MiniValine/MiniValine/blob/master/.github/FAQ.md#how-to-customize-emoticons">此文档</a></p><p>推荐使用项目 <a href="https://github.com/PikaSama/blog-emoticons/">Blog Emoticons</a>一键生成表情包列表(再次硬广)</p>').insertAfter(i+":eq(2)"),$("textarea#mvsys").val(v),c=localStorage.getItem("click_effect"),g(3,'<p>默认的点击特效，共三种可选</p><div class="input-radio"><input id="effect_0" type="radio" name="clickeffect" /><label for="effect_0"><span>爱心&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="effect_1" type="radio" name="clickeffect" /><label for="effect_1"><span>粒子波动&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="effect_2" type="radio" name="clickeffect" /><label for="effect_2"><span>粒子爆炸&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div>'),_("effect",c),u=localStorage.getItem("live2d"),g(4,'<p>是否启用Live2d看板娘</p><p>呐呐，这么Kawaii的看板娘，你不会关掉的，对吧对吧?</p><div class="input-radio"><input id="live2d_1" type="radio" name="live2d" /><label for="live2d_1"><span>是&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="live2d_0" type="radio" name="live2d" /><label for="live2d_0"><span>否&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div>'),_("live2d",u),m=localStorage.getItem("wordcount_mode"),g(5,'<p>统计功能的样式</p><div class="input-radio"><input id="wordcount_0"type="radio"name="wordcount"/><label for="wordcount_0"><span>字数-代码数-阅读时间-访问统计&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="wordcount_1"type="radio"name="wordcount"/><label for="wordcount_1"><span>字数(包含代码数)-阅读时间-访问统计&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="wordcount_2"type="radio"name="wordcount"/><label for="wordcount_2"><span>主题自带样式(简洁)</span></label></div>'),_("wordcount",m),K(),H(),await O()},M=async()=>{$('<div class="loadAni"><div class="loading"><i><span></span><span></span><span></span><span></span><span></span><span></span></i></div></div>').insertAfter(".φfs.φf header"),null==t?(await delay(1e3),$('<p>读取用户配置文件失败：未满足读取条件，需查看<a href="/help">使用教程</a></p>').insertAfter(i+":eq(0)")):null==s&&null!=t?(await delay(1e3),$("<p>用户配置文件为空，已自动创建新配置文件</p><p>如果要修改配置文件，点击保存按钮即可生效</p>").insertAfter(i+":eq(0)"),localStorage.setItem("custom","1"),N(),$('<p>是否自动切换黑暗模式</p><p>注意：若开启此选项，在黑暗模式的工作时间内将会覆盖默认主题，设置为黑暗主题</p><p>黑暗模式时间段：19:00~6:00</p><div class="input-radio"><input id="autonight_1"type="radio"name="autonight"/><label for="autonight_1"><span>是&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="autonight_0"type="radio"name="autonight" checked/><label for="autonight_0"><span>否&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div>').insertAfter(e+":eq(0)"),$('<p>默认的主题样式</p><div class="input-radio"><input id="theme_0"type="radio"name="theme" checked/><label for="theme_0"><span>默认&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="theme_1"type="radio"name="theme"/><label for="theme_1"><span>黑暗&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="theme_2"type="radio"name="theme"/><label for="theme_2"><span>樱花&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="theme_3"type="radio"name="theme"/><label for="theme_3"><span>雨滴&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="theme_4"type="radio"name="theme"/><label for="theme_4"><span>陈年旧书&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div>').insertAfter(e+":eq(1)"),$('<p>默认的强调色主题，修改行内代码块，小圆点部件，按钮激活色，滚动条颜色等，可与上面的主题进行搭配，共有12种选择</p><p>注意：背景指侧边栏背景，仅适用于移动端，无特别标注的强调色的背景为纯色背景</p><div class="input-radio"><input id="widget_0"type="radio"name="widget" checked/><label for="widget_0"><span>默认(清新蓝)&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_1"type="radio"name="widget"/><label for="widget_1"><span>活力橙(黑眼镜橙色底背景)&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_2"type="radio"name="widget"/><label for="widget_2"><span>DDの桃(粉色渐变背景)&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_3"type="radio"name="widget"/><label for="widget_3"><span>夜の海(黑色海洋背景)&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_4"type="radio"name="widget"/><label for="widget_4"><span>基佬紫&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_5"type="radio"name="widget"/><label for="widget_5"><span>夜空蓝&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_6"type="radio"name="widget"/><label for="widget_6"><span>天依蓝&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_7"type="radio"name="widget"/><label for="widget_7"><span>奥托绿&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_8"type="radio"name="widget"/><label for="widget_8"><span>清新绿&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_9"type="radio"name="widget"/><label for="widget_9"><span>清新橙&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_10"type="radio"name="widget"/><label for="widget_10"><span>普通橙&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_11"type="radio"name="widget"/><label for="widget_11"><span>马鞍棕&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="widget_12"type="radio"name="widget"/><label for="widget_12"><span>酷炫黑&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div>').insertAfter(e+":eq(2)"),$('<p>使用强调色时是否更改侧边栏的背景为强调色自带的背景</p><p>注意：此选项仅针对移动端，PC端设置此选项无效</p><div class="input-radio"><input id="sidebar_1" type="radio" name="sidebar" /><label for="sidebar_1"><span>是&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="sidebar_0" type="radio" name="sidebar" checked/><label for="sidebar_0"><span>否&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div>').insertAfter(e+":eq(3)"),$('<p>你可以自定义评论系统加载的表情包，一行填一个链接，不需要其他符号，以免解析错误</p><center><textarea id="mvsys" rows="10" style="resize: none;"></textarea></center><p>目前博客自带的表情包有以下这些，如果要使用这些表情包，请填入“https://cdn.jsdelivr.net/gh/PikaSama/blog-emoticons@latest/” + 表情包名字 即可</p><ul><li><p>BilibiliHotKey：哔哩哔哩热词系列</p></li><li><p>HONKAI3-Crayon：崩坏3 蜡笔日常篇</p></li><li><p>HONKAI3-Daily：崩坏3 日常篇</p></li><li><p>HONKAI3-Durandal-Search： 崩坏3 目标！幽兰黛尔</p></li><li><p>HONKAI3-MEI：崩坏3 芽衣的剑道修行</p></li><li><p>HONKAI3-NEWYEAR-2019：崩坏3 2019新年</p></li><li><p>HONKAI3-Pure：崩坏3 纯色日常篇</p></li><li><p>HONKAI3-Stan：崩坏3 史丹</p></li><li><p>HONKAI3-Star：崩坏3 观星篇</p></li><li><p>HONKAI3-AIChan：崩坏3 爱酱</p></li><li><p>Mafumafu：Mafumafu Animation sticker (cat)</p></li><li><p>Menhera-chan：七濑胡桃系列表情包</p></li><li><p>Sweetie-Bunny：うさみみ少女</p></li><li><p>Coolapk：酷安</p></li><li><p>Arcaea：Arcaea表情包</p></li><li><p>Snow-Miku：Snow Miku雪初音表情包</p></li><li><p>Yurui-Neko：Yurui-Neko表情包</p></li><li><p>bilibilitv：哔哩哔哩小电视系列\t</p></li><li><p>bilibili2233：哔哩哔哩2233娘系列</p></li><li><p>aodamiao：aodamiao嗷大喵</p></li></ul><p>如果你想加入自己的表情包，请见<a href="https://github.com/MiniValine/MiniValine/blob/master/.github/FAQ.md#how-to-customize-emoticons">此文档</a></p><p>推荐使用项目 <a href="https://github.com/PikaSama/blog-emoticons/">Blog Emoticons</a>一键生成表情包列表(再次硬广)</p>').insertAfter(i+":eq(2)"),$('<p>默认的点击特效，共三种可选</p><div class="input-radio"><input id="effect_0" type="radio" name="clickeffect" checked/><label for="effect_0"><span>爱心&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="effect_1" type="radio" name="clickeffect" /><label for="effect_1"><span>粒子波动&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="effect_2" type="radio" name="clickeffect" /><label for="effect_2"><span>粒子爆炸&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div>').insertAfter(i+":eq(3)"),$('<p>是否启用Live2d看板娘</p><p>呐呐，这么Kawaii的看板娘，你不会关掉的，对吧对吧?</p><div class="input-radio"><input id="live2d_1" type="radio" name="live2d" checked/><label for="live2d_1"><span>是&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="live2d_0" type="radio" name="live2d" /><label for="live2d_0"><span>否&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div>').insertAfter(i+":eq(4)"),$('<p>统计功能的样式</p><div class="input-radio"><input id="wordcount_0"type="radio"name="wordcount" checked/><label for="wordcount_0"><span>字数-代码数-阅读时间-访问统计&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="wordcount_1"type="radio"name="wordcount"/><label for="wordcount_1"><span>字数(包含代码数)-阅读时间-访问统计&nbsp;&nbsp;&nbsp;&nbsp;</span></label></div><div class="input-radio"><input id="wordcount_2"type="radio"name="wordcount"/><label for="wordcount_2"><span>主题自带样式(简洁)</span></label></div>').insertAfter(i+":eq(5)"),$("textarea#mvsys").val(v),await(async()=>{K(),H(),await O()})()):null!=s&&null!=t&&(await delay(1e3),$("<p>成功读取配置文件</p><p>如果要修改配置文件，点击保存按钮即可生效</p>").insertAfter(i+":eq(0)"),await q())};"/settings"==a&&await M()})();